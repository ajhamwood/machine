var $=(()=>{let i=new WeakMap,o=Object.values,s=Promise.resolve.bind(Promise),a=(e,t)=>e.constructor===t||t.prototype.isPrototypeOf(e),l=(e,t,n,r=i.get(e)??{})=>{c(e,t,n.name);e.addEventListener(t,(r[t]??={})[n.name]=n);i.set(e,r)},c=(e,t,n,r=i.get(e))=>{if(r&&t in r&&n in r[t]){e.removeEventListener(t,r[t][n]);delete r[t][n]&&(o(r[t]).length||delete r[t])&&(o(r).length||i.delete(e))}};return Object.assign((e,t=document)=>t.querySelector(e),{all(e,t=document){return o(t.querySelectorAll(e))},Machine:((i,n)=>class{constructor(e){n=Object.seal(e);for(let t in n)Object.defineProperty(this,t,{get:()=>n[t],set:e=>n[t]=e})}state(){return n}on(e,t){(i[e]??=new Map).set(t.name,t);return this}stop(e,t=e){i[e]?.delete(t)&&(i[e].size||delete i[e]);return this}emit(e,...n){return(t=>(i[e]?.forEach(e=>t[e.name]=e.apply(this,n)),t))({})}emitAsync(t,...r){return(e=>(i[t]?.forEach(n=>e=e.then(t=>s(n.apply(this,r)).then(e=>({...t,[n.name]:e})))),e))(s({}))}})({}),pipe:(n=>(e,...t)=>n[e]=(n[e]??s()).then(()=>Promise.all(t.map(e=>a(e,Array)&&Promise.race(e.map(e=>e()))||a(e,Function)&&e()))))({}),targets(n,r=window){for(let t in n)if(a(n[t],Function)){if(a(r,$.Machine))t.split(" ").forEach(e=>r.on(e,n[t]));else if(a(r,EventTarget))t.split(" ").forEach(e=>l(r,e,n[t].bind(r)))}else if(a(n[t],String)){if(a(r,$.Machine))t.split(" ").forEach(e=>r.stop(e,n[t]));else if(a(r,EventTarget))t.split(" ").forEach(e=>c(r,e,"bound "+n[t]))}else if(t in r)$.targets(n[t],r[t]);else for(let e in r)if(e.match(new RegExp(`^${t}$`)))$.targets(n[t],r[e])},queries(i,t){for(let r in i){let e=$.all(r,t);if(e.length)for(let n in i[r])if(a(i[r][n],Function))n.split(" ").forEach(t=>e.forEach(e=>l(e,t,i[r][n].bind(e))));else if(a(i[r][n],String))n.split(" ").forEach(t=>e.forEach(e=>c(e,t,"bound "+i[r][n])))}},load(e,t="body",n){return $.all(t,n).map(t=>o($("template#"+e).content.cloneNode(true).children).map(e=>t.appendChild(e)))},loadWc(t,{constructor:n,...e},r=[]){class i extends HTMLElement{static get observedAttributes(){return r}constructor(...e){super();this.attachShadow({mode:"open"}).appendChild($("#"+t).content.cloneNode(true));n.apply(this,e)}}Object.assign(i.prototype,e);customElements.define(t,i)}})})();